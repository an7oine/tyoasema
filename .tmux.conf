# Ohjeet:
# - Mikrobitti 9/2020
# - https://medium.com/@yash.kulshrestha/using-zsh-tmux-and-vim-for-web-development-eff7bd60e5d6
# - https://blog.petrzemek.net/2016/02/11/my-tmux-configuration/

# Päätteen tyyppi.
set -g default-terminal "screen-256color"

# Ohjeet, Mikrobitti 9/2020

# Käytetään Ctrl–B:n sijaan Ctrl–välilyöntiä esinäppäimenä.
# MB: Ctrl–A
unbind C-b
set -g prefix C-Space
bind-key C-Space send-prefix

# Ladataan asetukset uudelleen esinäppäin+R -yhdistelmällä.
bind-key r source-file ~/.tmux.conf\; display-message "Tmux.conf ladattu."

# Jaa paneelit; yhdysmerkki: pystysuunnassa; alaviiva: vaakasuunnassa.
unbind %
unbind '"'
bind - split-window -v
bind | split-window -h

# Siirry ikkunoiden välillä välilyönnillä / askelpalauttimella.
bind space next-window
bind bspace previous-window
bind enter next-layout

# Siirry paneeleiden välillä: Control–HJKL.
# MB: Meta–nuolet
# bind -n C-H select-pane -L
# bind -n C-L select-pane -R
# bind -n C-K select-pane -U
# bind -n C-J select-pane -D

# Siirrytään Vim-ikkunoiden ja Tmux-paneelien välillä Ctrl-HJKL-näppäimillä.
# Ks. https://www.codeography.com/2013/06/19/navigating-vim-and-tmux-splits
bind -n C-H run \
  "(tmux display-message -p '#{pane_title}' | grep -q '\\(- VIM$\\|^vim$\\)' && tmux send-keys C-h) || (tmux select-pane -L || true)"
bind -n C-J run \
  "(tmux display-message -p '#{pane_title}' | grep -q '\\(- VIM$\\|^vim$\\)' && tmux send-keys C-j) || (tmux select-pane -D || true)"
bind -n C-K run \
  "(tmux display-message -p '#{pane_title}' | grep -q '\\(- VIM$\\|^vim$\\)' && tmux send-keys C-k) || (tmux select-pane -U || true)"
bind -n C-L run \
  "(tmux display-message -p '#{pane_title}' | grep -q '\\(- VIM$\\|^vim$\\)' && tmux send-keys C-l) || (tmux select-pane -R || true)"

# Vaihda paneelien paikkaa keskenään: esinäppäin+Ctrl–O
bind C-O rotate-window

# Muuta paneeleiden kokoa: Shift–HJKL.
# MB: Shift–nuolet
# bind -n S-H resize-pane -L 5
# bind -n S-L resize-pane -R 5
# bind -n S-K resize-pane -U 5
# bind -n S-J resize-pane -D 5

# Siirry kopiointitilaan: esinäppäin + V.
bind v copy-mode

# Rullaa hiirellä.
set -g mouse on
setw -g mouse on

# Aseta Vi-tyyliset näppäimet.
set -g status-keys vi
setw -g mode-keys vi

# Aloita ikkunoiden ja paneelien numerointi ykkösestä.
set -g base-index 1
setw -g pane-base-index 1

# Päivitä ikkunaotsikot.
set -g set-titles on
set -g renumber-windows on


# Kopioi sana kaksoisnapsautuksella; rivi Vaihto + kaksoisnapsautuksella.
bind -n DoubleClick1Pane \
    select-pane \; \
    copy-mode -M \; \
    send-keys -X select-word \; \
    run-shell "sleep .5s" \; \
    send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi DoubleClick1Pane \
    send-keys -X select-word \; \
    run-shell "sleep .5s" \; \
    send-keys -X copy-pipe "pbcopy"

bind -n S-DoubleClick1Pane \
    select-pane \; \
    copy-mode -M \; \
    send-keys -X select-line \; \
    run-shell "sleep .5s" \; \
    send-keys -X copy-pipe-and-cancel "pbcopy"
bind -T copy-mode-vi S-DoubleClick1Pane \
    send-keys -X select-line \; \
    run-shell "sleep .5s" \; \
    send-keys -X copy-pipe "pbcopy"

# setw -g aggressive-resize on
# setw -g allow-rename off
# setw -g alternate-screen on
# setw -g automatic-rename on
# setw -g automatic-rename-format "#{?pane_in_mode,[tmux],#{pane_current_command}}#{?pane_dead,[dead],}"
# setw -g clock-mode-colour blue
setw -g clock-mode-style 24
# setw -g main-pane-height 24
# setw -g main-pane-width 80
# setw -g mode-style fg=black,bg=yellow
setw -g monitor-activity on
setw -g monitor-bell off
# setw -g monitor-silence 0
# setw -g other-pane-height 0
# setw -g other-pane-width 0
# setw -g pane-active-border-style fg=#6272a4
# setw -g pane-base-index 0
# setw -g pane-border-format "#{?pane_active,#[reverse],}#{pane_index}#[default] \"#{pane_title}\""
# setw -g pane-border-status off
# setw -g pane-border-style fg=#44475a
# setw -g remain-on-exit off
# setw -g synchronize-panes off
# setw -g window-active-style default
# setw -g window-size latest
# setw -g window-style default
# setw -g window-status-activity-style bright
# setw -g window-status-bell-style bright
# setw -g window-status-current-format "#[fg=#f8f8f2,bg=#6272a4] #I #W "
# setw -g window-status-current-style default
# setw -g window-status-format "#[fg=#f8f8f2]#[bg=#44475a] #I #W"
# setw -g window-status-last-style default
# setw -g window-status-separator " "
# setw -g window-status-style default
# setw -g wrap-search on
# setw -g xterm-keys on

# Laajennostyökalu.
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

# Kopiointi järjestelmän leikepöydälle.
set -g @plugin 'tmux-plugins/tmux-yank'

# Jatkuva tmux-ikkunoinnin tilan tallennus.
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Kopiointi ja haku säännöllisellä lausekkeella.
set -g @plugin 'tmux-plugins/tmux-copycat'

# Linkkien avaaminen konentorivin ulkopuolella.
set -g @plugin 'tmux-plugins/tmux-open'

# Tilarivi.
set -g @plugin 'tmux-plugins/tmux-cpu'

# Dracula-teema.
set -g @plugin 'dracula/tmux'

# Käynnistä Tpm.
run -b '~/.tmux/plugins/tpm/tpm'
